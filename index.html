<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
<meta property="og:type" content="website">
<meta property="og:title" content="Bruce Liu&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Bruce Liu&#39;s Blog">
<meta property="og:description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bruce Liu&#39;s Blog">
<meta name="twitter:description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">






  <link rel="canonical" href="http://yoursite.com/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Bruce Liu's Blog</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Bruce Liu's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Stay Hungry, Stay Foolish</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/27/MysqlExplain的type字段/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/12/27/MysqlExplain的type字段/" class="post-title-link" itemprop="http://yoursite.com/index.html">MysqlExplain的type字段</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-12-27 19:00:40 / 修改时间：21:45:44" itemprop="dateCreated datePublished" datetime="2020-12-27T19:00:40+08:00">2020-12-27</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>mysql</code> 使用 <code>explain</code> 命令进行分析时 <code>type</code> 字段会有下面几种 <code>join type</code>类型</p>
<p>查询效率<strong>由好到差</strong></p>
<ul>
<li><p><strong>system</strong></p>
<p>这个表只有一行（这个表是系统表），这是 <code>join type</code> =  <code>const</code> 的一种特殊形式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span></span><br><span class="line">	* </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	<span class="string">`mysql`</span>.<span class="string">`proxies_priv`</span></span><br></pre></td></tr></table></figure>
<p>查询结果如下</p>
<p>| id   | select_type | table        | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra |<br>| —- | ———– | ———— | ———- | —- | ————- | —- | ——- | —- | —- | ——– | —– |<br>| 1    | SIMPLE      | proxies_priv | system     |      |               |      |         | 1    | 100  |          |       |</p>
</li>
<li><p><strong>const</strong></p>
<p>表中只有一行匹配的数据，在 <code>where</code> 条件中和所有 </p>
<p>1)<code>主键</code></p>
<p>2) 唯一键</p>
<p>进行比较时会用到 <code>const</code></p>
<p>比如有如下表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `tb_name` (</span><br><span class="line">  `pp1` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `pp2` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `f3` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `f4` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  UNIQUE KEY `pp1` (`pp1`,`pp2`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</span><br><span class="line"></span><br><span class="line">INSERT INTO `db02`.`tb_name`(`pp1`, `pp2`, `f3`, `f4`) VALUES (&apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `db02`.`tb_name`(`pp1`, `pp2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;3&apos;, &apos;4&apos;, &apos;5&apos;);</span><br></pre></td></tr></table></figure>
<p>执行如下查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT</span><br><span class="line">	* </span><br><span class="line">FROM</span><br><span class="line">	`tb_name` </span><br><span class="line">WHERE</span><br><span class="line">	pp1 = &apos;1&apos; </span><br><span class="line">	AND pp2 = &apos;2&apos;</span><br><span class="line">## 或者</span><br><span class="line">EXPLAIN SELECT</span><br><span class="line">	* </span><br><span class="line">FROM</span><br><span class="line">	`tb_name` </span><br><span class="line">WHERE</span><br><span class="line">	pp2 = &apos;2&apos; </span><br><span class="line">	AND pp1 = &apos;1&apos;</span><br><span class="line">都会使用 const</span><br></pre></td></tr></table></figure>
<p>结果如下</p>
<p>| id   | select_type | table   | partitions | type  | possible_keys | key  | key_len | ref         | rows | filtered | Extra |<br>| —- | ———– | ——- | ———- | —– | ————- | —- | ——- | ———– | —- | ——– | —– |<br>| 1    | SIMPLE      | tb_name |            | const | pp1           | pp1  | 2046    | const,const | 1    | 100      |       |</p>
</li>
<li><p><strong>eq_ref</strong></p>
<p>前表的每一行，在后表中只有一行被扫描</p>
<blockquote>
<p>One row is read from this table for each combination of rows from the previous tables.</p>
</blockquote>
<p>有如下两张表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `students` (</span><br><span class="line">  `id` int(11) NOT NULL,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `age` int(3) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</span><br><span class="line"></span><br><span class="line">INSERT INTO `db02`.`students`(`id`, `name`, `age`) VALUES (1, &apos;张三&apos;, 23);</span><br><span class="line">INSERT INTO `db02`.`students`(`id`, `name`, `age`) VALUES (2, &apos;李四&apos;, 33);</span><br><span class="line"></span><br><span class="line">CREATE TABLE `scores` (</span><br><span class="line">  `user_id` int(11) NOT NULL,</span><br><span class="line">  `score` int(255) DEFAULT NULL</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;\</span><br><span class="line">INSERT INTO `db02`.`scores`(`user_id`, `score`) VALUES (1, 100);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXPLAIN SELECT</span><br><span class="line">	* </span><br><span class="line">FROM</span><br><span class="line">	students t1,</span><br><span class="line">	scores t2 </span><br><span class="line">WHERE</span><br><span class="line">	t1.id = t2.user_id</span><br></pre></td></tr></table></figure>
<p>可见 <code>scores</code> 表中只有一条数据，结果如下，</p>
<p>| id   | select_type | table | partitions | type   | possible_keys | key     | key_len | ref             | rows | filtered | Extra |<br>| —- | ———– | —– | ———- | —— | ————- | ——- | ——- | ————— | —- | ——– | —– |<br>| 1    | SIMPLE      | t2    |            | ALL    | PRIMARY       |         |         |                 | 1    | 100      |       |<br>| 1    | SIMPLE      | t1    |            | eq_ref | PRIMARY       | PRIMARY | 4       | db02.t2.user_id | 1    | 100      |       |</p>
<p>如果再往 <code>score</code> 表中 插入一行数据，则会变为全表扫描</p>
</li>
<li><p><strong>ref</strong></p>
<p>非唯一性索引扫描，返回匹配某个单独值的所有行. 这个索引</p>
<p>1) 不是 <strong>主键</strong> 也不是 <strong>唯一键</strong></p>
<p>或者</p>
<p>2）使用最左匹配原则进行匹配</p>
<p>ref 虽然使用了索引，但是查询结果并不唯一，但是并不需要扫描全表，因为索引时有序的</p>
<p>有如下两个表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `tb_ref` (</span><br><span class="line">  `f1` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `f2` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `f3` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  `f4` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL,</span><br><span class="line">  KEY `index_tb_ref_f1` (`f1`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</span><br><span class="line">## 一定要多添 `tb_ref` 一定要多添加几条数据，如果数据太少 mysql 直接会使用全表扫描 type=ALL</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line">INSERT INTO `tb_ref`(`f1`, `f2`, `f3`, `f4`) VALUES (&apos;2&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE `other_table` (</span><br><span class="line">  `ref_f1` varchar(255) COLLATE utf8mb4_bin NOT NULL,</span><br><span class="line">  `age` int(3) DEFAULT NULL,</span><br><span class="line">  `name` varchar(255) COLLATE utf8mb4_bin DEFAULT NULL</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</span><br><span class="line"></span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;1&apos;, 22, &apos;张三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;1&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br><span class="line">INSERT INTO `other_table`(`ref_f1`, `age`, `name`) VALUES (&apos;2&apos;, 23, &apos;张1三&apos;);</span><br></pre></td></tr></table></figure>
<p>执行如下语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT</span><br><span class="line">	* </span><br><span class="line">FROM</span><br><span class="line">	tb_ref </span><br><span class="line">WHERE</span><br><span class="line">	f1=&apos;1&apos;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p>| id   | select_type | table  | partitions | type | possible_keys   | key             | key_len | ref   | rows | filtered | Extra |<br>| —- | ———– | —— | ———- | —- | ————— | ————— | ——- | —– | —- | ——– | —– |<br>| 1    | SIMPLE      | tb_ref |            | ref  | index_tb_ref_f1 | index_tb_ref_f1 | 1023    | const | 1    | 100      |       |</p>
<p>执行如下语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT</span><br><span class="line">	* </span><br><span class="line">FROM</span><br><span class="line">	tb_ref t1,</span><br><span class="line">	other_table t2 </span><br><span class="line">WHERE</span><br><span class="line">	t1.f1 = t2.ref_f1</span><br></pre></td></tr></table></figure>
<p>返回结果</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>id</th>
<th>select_type</th>
<th>table</th>
<th>partitions</th>
<th>type</th>
<th>possible_keys</th>
<th>key</th>
<th>key_len</th>
<th>ref</th>
<th>rows</th>
<th>filtered</th>
<th>Extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SIMPLE</td>
<td>t2</td>
<td></td>
<td>ALL</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>9</td>
<td>100</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>SIMPLE</td>
<td>t1</td>
<td></td>
<td>ref</td>
<td>index_tb_ref_f1</td>
<td>index_tb_ref_f1</td>
<td>1023</td>
<td>db02.t2.ref_f1</td>
<td>1</td>
<td>100</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>range</strong></p>
<p>range 是范围扫描，当比较索引列包含 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=, &lt;&gt;, &gt;, &gt;=, &lt;,&lt;=, IS NULL, &lt;=&gt;, BETWEEN, LIKE, or IN()</span><br></pre></td></tr></table></figure>
<p>时，可能产生 <code>range</code></p>
<blockquote>
<p>Only rows that are in a given range are retrieved, using an index to select the rows. The key column in the output row indicates which index is used. The key_len contains the longest key part that was used. The ref column is NULL for this type. range can be used when a key column is compared to a constant using any of the =, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, &lt;=&gt;, BETWEEN, LIKE, or IN() operators: SELECT <em> FROM tbl_name WHERE key_column = 10; SELECT </em> FROM tbl_name WHERE key_column BETWEEN 10 and 20; SELECT <em> FROM tbl_name 1351 EXPLAIN Output Format WHERE key_column IN (10,20,30); SELECT </em> FROM tbl_name WHERE key_part1 = 10 AND key_part2 IN (10,20,30);</p>
</blockquote>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/24/HashMap面试题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/12/24/HashMap面试题/" class="post-title-link" itemprop="http://yoursite.com/index.html">HashMap面试题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-12-24 15:50:26" itemprop="dateCreated datePublished" datetime="2020-12-24T15:50:26+08:00">2020-12-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-12-26 11:57:28" itemprop="dateModified" datetime="2020-12-26T11:57:28+08:00">2020-12-26</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题一"><a href="#问题一" class="headerlink" title="问题一"></a>问题一</h2><p>为什么容量一定是2的幂？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash &amp; (length-1)</span><br></pre></td></tr></table></figure></p>
<p>如果 <code>length</code> = 16，则 <code>length-1</code> = 15=1111;</p>
<p>如果hash 是一个32 位的整数，最后四位是 1001</p>
<p>…. …. …. 1001</p>
<p>&amp;             1111</p>
<p>​                1001</p>
<p>所以使用这种按位与的方法很容易，求出 <code>hash % length</code> 的值</p>
<p>JAVA 8 HashMap的改进</p>
<p>数组+链表/红黑树</p>
<p>扩容时插入顺序的改进</p>
<p>函数方法</p>
<p>​       forEach</p>
<p>​       compute系列</p>
<p>Map的新Api</p>
<p>​       merge</p>
<p>​       replace</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/22/正则表达式相关/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/10/22/正则表达式相关/" class="post-title-link" itemprop="http://yoursite.com/index.html">正则表达式相关</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-10-22 16:01:13" itemprop="dateCreated datePublished" datetime="2020-10-22T16:01:13+08:00">2020-10-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-10-23 15:25:31" itemprop="dateModified" datetime="2020-10-23T15:25:31+08:00">2020-10-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="提取中括号中间的内容"><a href="#提取中括号中间的内容" class="headerlink" title="提取中括号中间的内容"></a>提取中括号中间的内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">String s = &quot;[102.8164002309, 24.9892758419], [102.8165296922, 24.9887447331], [102.8168627242, 24.9887980873], [102.8169049102, 24.9890462091], [102.816831012, 24.989382232], [102.8166749033, 24.9893820851], [102.8164002309, 24.9892758419]&quot;;</span><br><span class="line">        // 包含中括号</span><br><span class="line">        Pattern pattern = Pattern.compile(&quot;(\\[.*?])&quot;);</span><br><span class="line">        // 不包含中括号</span><br><span class="line">        Pattern pattern1 = Pattern.compile(&quot;\\[(.*?)]&quot;);</span><br><span class="line"></span><br><span class="line">        Matcher matcher = pattern.matcher(s);</span><br><span class="line">        while (matcher.find()) &#123;</span><br><span class="line">            System.out.println(matcher.group(1));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;------------------------&quot;);</span><br><span class="line">        Matcher matcher2 = pattern1.matcher(s);</span><br><span class="line">        while (matcher2.find()) &#123;</span><br><span class="line">            System.out.println(matcher2.group(1));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>打印结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[102.8164002309, 24.9892758419]</span><br><span class="line">[102.8165296922, 24.9887447331]</span><br><span class="line">[102.8168627242, 24.9887980873]</span><br><span class="line">[102.8169049102, 24.9890462091]</span><br><span class="line">[102.816831012, 24.989382232]</span><br><span class="line">[102.8166749033, 24.9893820851]</span><br><span class="line">[102.8164002309, 24.9892758419]</span><br><span class="line">------------------------</span><br><span class="line">102.8164002309, 24.9892758419</span><br><span class="line">102.8165296922, 24.9887447331</span><br><span class="line">102.8168627242, 24.9887980873</span><br><span class="line">102.8169049102, 24.9890462091</span><br><span class="line">102.816831012, 24.989382232</span><br><span class="line">102.8166749033, 24.9893820851</span><br><span class="line">102.8164002309, 24.9892758419</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/16/mysql-groupby报错/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/09/16/mysql-groupby报错/" class="post-title-link" itemprop="http://yoursite.com/index.html">mysql-groupby报错</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-09-16 11:03:12 / 修改时间：11:56:15" itemprop="dateCreated datePublished" datetime="2020-09-16T11:03:12+08:00">2020-09-16</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="mysql-groupBy问题"><a href="#mysql-groupBy问题" class="headerlink" title="mysql groupBy问题"></a>mysql groupBy问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column &apos;xxx&apos; which is not </span><br><span class="line">functionally dependent on columns  in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</span><br></pre></td></tr></table></figure>
<h3 id="解决办法一"><a href="#解决办法一" class="headerlink" title="解决办法一"></a>解决办法一</h3><ol>
<li><p>查询 sql_mode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@global.sql_mode;</span><br></pre></td></tr></table></figure>
<p>结果如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br></pre></td></tr></table></figure>
<p>只需要将上面的 <code>ONLY_FULL_GROUP_BY</code> 去掉就行</p>
<p>使用如下语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @@global.sql_mode=&apos;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&apos;;</span><br></pre></td></tr></table></figure>
<p>这种方法存在的问题</p>
<ol>
<li>在有些时候不生效</li>
<li>mysql重启之后配置失效</li>
</ol>
</li>
</ol>
<h3 id="解决办法二"><a href="#解决办法二" class="headerlink" title="解决办法二"></a>解决办法二</h3><p>打开 <code>mysql</code>配置文件 <code>my.cnf</code>,在最下面添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br></pre></td></tr></table></figure>
<p>使用这种方法会永久解决上面的报错问题</p>
<p>P.S. 如果 <code>mysql</code> 使用的是 <code>docker</code></p>
<p>在进入容器内部</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it my-mysql /bin/bash</span><br></pre></td></tr></table></figure>
<p>之后可能出现没有 <code>vi/vim</code> 工具导致无法修改配置文件</p>
<p>在此情况下首先执行 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br></pre></td></tr></table></figure>
<p>然后安装 vim</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install vim</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/31/maven的依赖机制/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/08/31/maven的依赖机制/" class="post-title-link" itemprop="http://yoursite.com/index.html">maven的依赖机制</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-08-31 14:55:02" itemprop="dateCreated datePublished" datetime="2020-08-31T14:55:02+08:00">2020-08-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-09-01 17:21:30" itemprop="dateModified" datetime="2020-09-01T17:21:30+08:00">2020-09-01</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="传递依赖关系（Transitive-Dependencies）"><a href="#传递依赖关系（Transitive-Dependencies）" class="headerlink" title="传递依赖关系（Transitive Dependencies）"></a>传递依赖关系（<code>Transitive Dependencies</code>）</h2><h3 id="依赖调解（Dependency-mediation）"><a href="#依赖调解（Dependency-mediation）" class="headerlink" title="依赖调解（Dependency mediation）"></a>依赖调解（<em>Dependency mediation</em>）</h3><p>这个机制决定了当遇到多个版本作为依赖项时，将选择该 <code>artifact</code> 的哪个版本。maven 使用 <code>最近定义（nearest definition）</code>的机制，就是说，它在maven关系树中使用最接近项目的以来关系版本。可以通过在当前工程的 <code>pom</code> 文件中在确保某个依赖的版本。当在<code>pom</code>中指定了某个依赖的不同版本时，以先声明的依赖版本为准</p>
<p> <code>（nearest definition）</code>它在maven关系树中使用最接近项目的以来关系版本，考虑下面的依赖树</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">├── B</span><br><span class="line">│   └── C</span><br><span class="line">│       └── D 2.0</span><br><span class="line">└── E</span><br><span class="line">    └── D 1.0</span><br></pre></td></tr></table></figure>
<p>定义了 A B C 三个模块，其中有两个依赖关系 A-&gt;B-&gt;C-&gt;D ,A-&gt;E-&gt;D,当构建 A时，使用的D是1.0 版本，因为 A-E-D这个依赖关系更短，如果要在构建A时强制使用D2.0版本，可以在A的依赖中明确指定 D2.0,依赖树如下图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line"> ├── B</span><br><span class="line"> │   └── C</span><br><span class="line"> │       └── D 2.0</span><br><span class="line"> ├── E</span><br><span class="line"> │   └── D 1.0</span><br><span class="line"> │</span><br><span class="line"> └── D 2.0</span><br></pre></td></tr></table></figure>
<h2 id="依赖域（Dependency-Scope）"><a href="#依赖域（Dependency-Scope）" class="headerlink" title="依赖域（Dependency Scope）"></a>依赖域（<em>Dependency Scope</em>）</h2><ul>
<li><strong>compile</strong><br>This is the <strong><em>default</em></strong> scope, used if none is specified. Compile dependencies are available in all classpaths of a project. Furthermore, those dependencies are propagated to dependent projects.</li>
<li><strong>provided</strong><br>This is much like <code>compile</code>, but indicates you expect the JDK or a container to provide the dependency at runtime. For example, when building a web application for the Java Enterprise Edition, you would set the dependency on the Servlet API and related Java EE APIs to scope <code>provided</code> because the web container provides those classes. A dependency with this scope is added to the classpath used for compilation and test, but not the runtime classpath. It is not transitive.</li>
<li><strong>runtime</strong><br>This scope indicates that the dependency is not required for compilation, but is for execution. Maven includes a dependency with this scope in the runtime and test classpaths, but not the compile classpath.</li>
<li><strong>test</strong><br>This scope indicates that the dependency is not required for normal use of the application, and is only available for the test compilation and execution phases. This scope is not transitive. Typically this scope is used for test libraries such as JUnit and Mockito. It is also used for non-test libraries such as Apache Commons IO if those libraries are used in unit tests (src/test/java) but not in the model code (src/main/java).</li>
<li><strong>system</strong><br>This scope is similar to <code>provided</code> except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository.</li>
<li><strong>import</strong><br>This scope is only supported on a dependency of type <code>pom</code> in the <code>&lt;dependencyManagement&gt;</code> section. It indicates the dependency is to be replaced with the effective list of dependencies in the specified POM’s <code>&lt;dependencyManagement&gt;</code> section. Since they are replaced, dependencies with a scope of <code>import</code> do not actually participate in limiting the transitivity of a dependency.</li>
</ul>
<p>在maven多模块项目中，为了保持模块间依赖的统一，常规做法是在parent model中，使用dependencyManagement预定义所有模块需要用到的dependency(依赖)</p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">        &lt;dependencies&gt;</span><br><span class="line">            &lt;!-- Feign是一种声明式、模板化的HTTP客户端:以HTTP接口的形式暴露自身服务 --&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;$&#123;spring-cloud-starter-feign.version&#125;&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">            &lt;!-- 支持面向方面的编程即AOP，包括spring-aop和AspectJ --&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;$&#123;spring.boot.version&#125;&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;$&#123;aspectjrt.version&#125;&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">        &lt;/dependencies&gt;</span><br><span class="line">    &lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p>然后，子model根据实际需要引入parent中预定义的依赖</p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p>好处：</p>
<p>1、依赖统一管理(parent中定义，需要变动dependency版本，只要修改一处即可)；</p>
<p>2、代码简洁(子model只需要指定groupId、artifactId即可)</p>
<p>3、dependencyManagement只会影响现有依赖的配置，但不会引入依赖，即子model不会继承parent中dependencyManagement所有预定义的depandency，只引入需要的依赖即可，简单说就是“按需引入依赖”或者“按需继承”；因此，在parent中严禁直接使用depandencys预定义依赖，坏处是子model会自动继承depandencys中所有预定义依赖；</p>
<p>但是，问题也出现了：</p>
<p>单继承：maven的继承跟java一样，单继承，也就是说子model中只能出现一个parent标签；</p>
<p>parent模块中，dependencyManagement中预定义太多的依赖，造成pom文件过长，而且很乱；</p>
<p>如何让这些依赖可以分类并清晰的管理？</p>
<p>问题解决：import scope依赖</p>
<p>如何使用：</p>
<p>1、maven2.9以上版本</p>
<p>2、将dependency分类，每一类建立单独的pom文件</p>
<p>3、在需要使用到这些依赖的子model中，使用dependencyManagement管理依赖，并import scope依赖</p>
<p>3、注意：scope=import只能用在dependencyManagement里面,且仅用于type=pom的dependency</p>
<p>示例：</p>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;!-- 重要：版本号要和父模块中预定义的spring boot版本号保持一致 --&gt;</span><br><span class="line">            &lt;version&gt;$&#123;spring.boot.version&#125;&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
<p><a href="javascript:void(0" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a>;)</p>
<p> maven编译后，下载了pom文件，在maven的本地仓库下查看pom文件如下：</p>
<p><img src="https://images.cnblogs.com/cnblogs_com/huahua035/805112/o_QQ%e6%88%aa%e5%9b%be20171017111114.png" alt="img"></p>
<p>好处分析：</p>
<p>1、单一职责原则，根据依赖的分类，细化每一个单一职责的pom文件</p>
<p>2、解决单继承问题，通过import pom文件达到依赖的目的（典型的非继承模式），从而不用从父类中引用依赖</p>
<p>3、父模块的pom就会非常干净，容易维护</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/11/java8tomap/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/08/11/java8tomap/" class="post-title-link" itemprop="http://yoursite.com/index.html">java8tomap</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-08-11 17:11:31 / 修改时间：17:12:41" itemprop="dateCreated datePublished" datetime="2020-08-11T17:11:31+08:00">2020-08-11</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Map&lt;String, JSONObject&gt; moudlesDataMap =</span><br><span class="line">             allModulesData.stream()</span><br><span class="line">                     .collect(Collectors.toMap(</span><br><span class="line">                             item -&gt; (item.get(<span class="string">"name"</span>).toString()), item -&gt; item, (oldValue, newValue) -&gt; newValue));</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/21/JWT-Token基础/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/07/21/JWT-Token基础/" class="post-title-link" itemprop="http://yoursite.com/index.html">JWT Token基础</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-07-21 10:15:55" itemprop="dateCreated datePublished" datetime="2020-07-21T10:15:55+08:00">2020-07-21</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/09/尚硅谷k8s笔记/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/07/09/尚硅谷k8s笔记/" class="post-title-link" itemprop="http://yoursite.com/index.html">尚硅谷k8s笔记</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-07-09 15:15:03" itemprop="dateCreated datePublished" datetime="2020-07-09T15:15:03+08:00">2020-07-09</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/30/spring跨域配置/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/30/spring跨域配置/" class="post-title-link" itemprop="http://yoursite.com/index.html">spring跨域配置</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-06-30 14:00:06 / 修改时间：14:03:19" itemprop="dateCreated datePublished" datetime="2020-06-30T14:00:06+08:00">2020-06-30</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以下内容来源于 <code>spring</code> 官方网站</p>
<p><a href="https://spring.io/blog/2015/06/08/cors-support-in-spring-framework" target="_blank" rel="noopener">https://spring.io/blog/2015/06/08/cors-support-in-spring-framework</a></p>
<h2 id="CORS-support-in-Spring-Framework"><a href="#CORS-support-in-Spring-Framework" class="headerlink" title="CORS support in Spring Framework"></a><a href="https://spring.io/blog/2015/06/08/cors-support-in-spring-framework" target="_blank" rel="noopener">CORS support in Spring Framework</a></h2><p><a href="https://spring.io/blog/2015/06/08/cors-support-in-spring-framework#disqus_thread" target="_blank" rel="noopener">https://spring.io/blog/2015/06/08/cors-support-in-spring-framework#disqus_thread</a>)</p>
<p>For security reasons, browsers prohibit AJAX calls to resources residing outside the current origin. For example, as you’re checking your bank account in one tab, you could have the evil.com website in another tab. The scripts from evil.com shouldn’t be able to make AJAX requests to your bank API (withdrawing money from your account!) using your credentials.</p>
<p><a href="https://spring.io/understanding/CORS" target="_blank" rel="noopener">Cross-origin resource sharing</a> (CORS) is a <a href="https://www.w3.org/TR/cors/" target="_blank" rel="noopener">W3C specification</a> implemented by <a href="https://caniuse.com/#feat=cors" target="_blank" rel="noopener">most browsers</a> that allows you to specify in a flexible way what kind of cross domain requests are authorized, instead of using some less secured and less powerful hacks like IFrame or JSONP.</p>
<p><a href="https://spring.io/blog/2015/07/31/spring-framework-4-2-goes-ga" target="_blank" rel="noopener">Spring Framework 4.2 GA</a> provides <a href="https://jira.spring.io/browse/SPR-9278" target="_blank" rel="noopener">first class support for CORS</a> out-of-the-box, giving you an easier and more powerful way to configure it than typical <a href="http://software.dzhuvinov.com/cors-filter.html" target="_blank" rel="noopener">filter based</a> solutions.</p>
<p>Spring MVC provides high-level configuration facilities, described bellow.</p>
<h2 id="Controller-method-CORS-configuration"><a href="#Controller-method-CORS-configuration" class="headerlink" title="Controller method CORS configuration"></a>Controller method CORS configuration</h2><p>You can add to your <code>@RequestMapping</code> annotated handler method a <a href="https://docs.spring.io/spring-framework/docs/4.2.x/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html" target="_blank" rel="noopener"><code>@CrossOrigin</code></a> annotation in order to enable CORS on it (by default <code>@CrossOrigin</code> allows all origins and the HTTP methods specified in the <code>@RequestMapping</code> annotation):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@CrossOrigin</span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It is also possible to enable CORS for the whole controller:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@CrossOrigin(origins = &quot;http://domain2.com&quot;, maxAge = 3600)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In this example CORS support is enabled for both <code>retrieve()</code> and <code>remove()</code> handler methods, and you can also see how you can customize the CORS configuration using <code>@CrossOrigin</code> attributes.</p>
<p>You can even use both controller and method level CORS configurations, Spring will then combine both annotation attributes to create a merged CORS configuration.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@CrossOrigin(maxAge = 3600)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/account&quot;)</span><br><span class="line">public class AccountController &#123;</span><br><span class="line"></span><br><span class="line">	@CrossOrigin(origins = &quot;http://domain2.com&quot;)</span><br><span class="line">	@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public Account retrieve(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">	public void remove(@PathVariable Long id) &#123;</span><br><span class="line">		// ...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, make sure to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well to allow it to leverage the configuration defined at Spring MVC level.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebSecurity</span><br><span class="line">public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">		http.cors().and()...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Global-CORS-configuration"><a href="#Global-CORS-configuration" class="headerlink" title="Global CORS configuration"></a>Global CORS configuration</h2><p>In addition to fine-grained, annotation-based configuration you’ll probably want to define some global CORS configuration as well. This is similar to using filters but can be declared withing Spring MVC and combined with fine-grained <code>@CrossOrigin</code> configuration. By default all origins and <code>GET</code>, <code>HEAD</code> and <code>POST</code> methods are allowed.</p>
<h3 id="JavaConfig"><a href="#JavaConfig" class="headerlink" title="JavaConfig"></a>JavaConfig</h3><p>Enabling CORS for the whole application is as simple as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableWebMvc</span><br><span class="line">public class WebConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">		registry.addMapping(&quot;/**&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Boot, it is recommended to just declare a <code>WebMvcConfigurer</code> bean as following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public WebMvcConfigurer corsConfigurer() &#123;</span><br><span class="line">        return new WebMvcConfigurerAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">                registry.addMapping(&quot;/**&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;COPY</span><br></pre></td></tr></table></figure>
<p>You can easily change any properties, as well as only apply this CORS configuration to a specific path pattern:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">	registry.addMapping(&quot;/api/**&quot;)</span><br><span class="line">		.allowedOrigins(&quot;http://domain2.com&quot;)</span><br><span class="line">		.allowedMethods(&quot;PUT&quot;, &quot;DELETE&quot;)</span><br><span class="line">			.allowedHeaders(&quot;header1&quot;, &quot;header2&quot;, &quot;header3&quot;)</span><br><span class="line">		.exposedHeaders(&quot;header1&quot;, &quot;header2&quot;)</span><br><span class="line">		.allowCredentials(false).maxAge(3600);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, make sure to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well to allow it to leverage the configuration defined at Spring MVC level.</p>
<h3 id="XML-namespace"><a href="#XML-namespace" class="headerlink" title="XML namespace"></a>XML namespace</h3><p>It is also possible to configure CORS with the <a href="https://jira.spring.io/browse/SPR-13046" target="_blank" rel="noopener">mvc XML namespace</a>.</p>
<p>This minimal XML configuration enable CORS on <code>/**</code> path pattern with the same default properties than the JavaConfig one:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:cors&gt;</span><br><span class="line">	&lt;mvc:mapping path=&quot;/**&quot; /&gt;</span><br><span class="line">&lt;/mvc:cors&gt;COPY</span><br></pre></td></tr></table></figure>
<p>It is also possible to declare several CORS mappings with customized properties:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:cors&gt;</span><br><span class="line"></span><br><span class="line">	&lt;mvc:mapping path=&quot;/api/**&quot;</span><br><span class="line">		allowed-origins=&quot;http://domain1.com, http://domain2.com&quot;</span><br><span class="line">		allowed-methods=&quot;GET, PUT&quot;</span><br><span class="line">		allowed-headers=&quot;header1, header2, header3&quot;</span><br><span class="line">		exposed-headers=&quot;header1, header2&quot; allow-credentials=&quot;false&quot;</span><br><span class="line">		max-age=&quot;123&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;mvc:mapping path=&quot;/resources/**&quot;</span><br><span class="line">		allowed-origins=&quot;http://domain1.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mvc:cors&gt;</span><br></pre></td></tr></table></figure>
<p>If you are using Spring Security, don’t forget to <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/cors.html" target="_blank" rel="noopener">enable CORS at Spring Security level</a> as well:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;http&gt;</span><br><span class="line">	&lt;!-- Default to Spring MVC&apos;s CORS configuration --&gt;</span><br><span class="line">	&lt;cors /&gt;</span><br><span class="line">	...</span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h2 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h2><p>CORS requests (<a href="https://github.com/spring-projects/spring-framework/blob/master/spring-webmvc/src/main/java/org/springframework/web/servlet/FrameworkServlet.java#L906" target="_blank" rel="noopener">including preflight ones with an <code>OPTIONS</code> method</a>) are automatically dispatched to the various <code>HandlerMapping</code>s registered. They handle CORS preflight requests and intercept CORS simple and actual requests thanks to a <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsProcessor.html" target="_blank" rel="noopener">CorsProcessor</a> implementation (<a href="https://github.com/spring-projects/spring-framework/blob/master/spring-web/src/main/java/org/springframework/web/cors/DefaultCorsProcessor.java" target="_blank" rel="noopener">DefaultCorsProcessor</a> by default) in order to add the relevant CORS response headers (like <code>Access-Control-Allow-Origin</code>). <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> allows you to specify how the CORS requests should be processed: allowed origins, headers, methods, etc. It can be provided in various ways:</p>
<ul>
<li><a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/servlet/handler/AbstractHandlerMapping.html#setCorsConfiguration-java.util.Map-" target="_blank" rel="noopener"><code>AbstractHandlerMapping#setCorsConfiguration()</code></a> allows to specify a <code>Map</code> with several <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> mapped on path patterns like <code>/api/**</code></li>
<li>Subclasses can provide their own <code>CorsConfiguration</code> by overriding <code>AbstractHandlerMapping#getCorsConfiguration(Object, HttpServletRequest)</code> method</li>
<li>Handlers can implement <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfigurationSource.html" target="_blank" rel="noopener"><code>CorsConfigurationSource</code></a> interface (like <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java" target="_blank" rel="noopener"><code>ResourceHttpRequestHandler</code></a> now does) in order to provide a <a href="https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/cors/CorsConfiguration.html" target="_blank" rel="noopener">CorsConfiguration</a> for each request.</li>
</ul>
<h2 id="Filter-based-CORS-support"><a href="#Filter-based-CORS-support" class="headerlink" title="Filter based CORS support"></a>Filter based CORS support</h2><p>As an alternative to other methods presented above, Spring Framework also provides a <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/filter/CorsFilter.html" target="_blank" rel="noopener">CorsFilter</a>. In that case, instead of using <code>@CrossOrigin</code> or <code>WebMvcConfigurer#addCorsMappings(CorsRegistry)</code>, you can for example declare the filter as following in your Spring Boot application:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyConfiguration &#123;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public FilterRegistrationBean corsFilter() &#123;</span><br><span class="line">		UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();</span><br><span class="line">		CorsConfiguration config = new CorsConfiguration();</span><br><span class="line">		config.setAllowCredentials(true);</span><br><span class="line">		config.addAllowedOrigin(&quot;http://domain1.com&quot;);</span><br><span class="line">		config.addAllowedHeader(&quot;*&quot;);</span><br><span class="line">		config.addAllowedMethod(&quot;*&quot;);</span><br><span class="line">		source.registerCorsConfiguration(&quot;/**&quot;, config);</span><br><span class="line">		FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));</span><br><span class="line">		bean.setOrder(0);</span><br><span class="line">		return bean;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/04/取余和取模的区别/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Liu">
      <meta itemprop="description" content="Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Liu's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/06/04/取余和取模的区别/" class="post-title-link" itemprop="http://yoursite.com/index.html">取余和取模的区别</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-06-04 11:04:34 / 修改时间：11:31:43" itemprop="dateCreated datePublished" datetime="2020-06-04T11:04:34+08:00">2020-06-04</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>取余%</code> 和 <code>取模 mod</code> 两种运算，既有相同之处也有不同的地方</p>
<p><code>a % b</code> 和 <code>a mod b</code> 的公式都为 <code>result = a - b * c ;c = a / b (b ≠ 0);</code> </p>
<p>两者的区别是 在于 <code>c</code> 的计算方式</p>
<p>在 <code>a % b</code> 时 ,<code>c</code>的结果<strong>向零取整</strong>，如 <code>a = 36, b = -10 则 c=-3</code>; </p>
<p>在 <code>a mod b</code> 时，<code>c</code>的结果向<strong>负无穷取整</strong>，如 <code>a = 36, b = -10 则 c=-4</code>因为比 <code>-3.6</code> 小的最接近的一个整数是 <code>-4</code> ; </p>
<p>所以 有如下的运算</p>
<p><code>36 % -10 = 36 - (-10) * c = 36 - (-10) *(-3) = 36 -30 = 6</code>，结果为 <code>6</code></p>
<p><code>36 mod 10 = 36 - (-10) * c = 36 - (-10) * (-4) = 36 -40 = -4</code> ,结果为 <code>-4</code>   </p>
<p>更一般的规律</p>
<p>在 <code>取余(%)</code>运算中，运算结果的符号和被除数(a)保持一致，即 <code>a</code> 为正，运算的结果就为正， <code>a</code> 为负，运算的结果就为负</p>
<p>在 <code>取模(mod)</code>运算中，运算结果的符号和除数(b)保持一致，即 <code>b</code> 为正，运算的结果就为正， <code>b</code> 为负，运算的结果就为负</p>
<p>在 <code>java</code> 中的运行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(36 % 10);  //6</span><br><span class="line">        System.out.println(36 % -10); //6</span><br><span class="line">        System.out.println(-36 % 10); //-6</span><br><span class="line">        System.out.println(-36 % -10); //-6</span><br><span class="line">        System.out.println(Math.floorMod(36, 10));  //6</span><br><span class="line">        System.out.println(Math.floorMod(36, -10)); //-4</span><br><span class="line">        System.out.println(Math.floorMod(-36, 10));  //4</span><br><span class="line">        System.out.println(Math.floorMod(-36, -10)); //-6</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">打印结果如下</span><br><span class="line">6</span><br><span class="line">6</span><br><span class="line">-6</span><br><span class="line">-6</span><br><span class="line">6</span><br><span class="line">-4</span><br><span class="line">4</span><br><span class="line">-6</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Bruce Liu</p>
              <p class="site-description motion-element" itemprop="description">Bruce Liu个人站，主要涉及前端知识共享、实践教程、前沿技术共同学习等方面</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">46</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/lastdetective" title="GitHub &rarr; https://github.com/lastdetective" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:xlgjsj004@sina.com" title="E-Mail &rarr; mailto:xlgjsj004@sina.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bruce Liu</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  










  





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
